<!doctype html>
<html lang="es">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Maria's Professional Cleaning — Calculadora (AZ)</title>
<style>
  :root{
    --bgA: #f3fbfb;
    --panel:#ffffff;
    --brand:#8b0000;       /* burgundy accent for Maria's brand */
    --accent:#2D9CDB;      /* cleaning blue */
    --muted:#f5f8fa;
    --text:#112;
    --success:#6FCF97;
    --radius:12px;
    --shadow: 0 10px 30px rgba(17,34,51,0.06);
  }
  *{box-sizing:border-box}
  body{
    margin:0;
    font-family: Inter, "Segoe UI", Roboto, Arial, sans-serif;
    background:linear-gradient(180deg,var(--bgA),#e6f7ff);
    color:var(--text);
    -webkit-font-smoothing:antialiased;
    -webkit-tap-highlight-color: transparent;
  }

  .wrap{max-width:1100px;margin:28px auto;padding:18px;display:grid;grid-template-columns:1fr;gap:18px}
  .header{display:flex;align-items:center;gap:14px}
  .logo{
    width:64px;height:64px;border-radius:12px;background:var(--brand);color:#fff;display:flex;
    align-items:center;justify-content:center;font-weight:800;font-size:20px;box-shadow:0 6px 18px rgba(0,0,0,0.08)
  }
  h1{margin:0;font-size:20px}
  p.lead{margin:4px 0 0;color:#455a64;font-size:13px}

  .layout{display:grid;grid-template-columns:420px 1fr;gap:18px;margin-top:8px}
  .card{background:var(--panel);border-radius:var(--radius);padding:16px;box-shadow:var(--shadow)}
  label{display:block;margin-top:10px;font-size:13px;color:#374151}
  .service-row{display:flex;gap:8px;margin-top:10px}
  .svc{flex:1;padding:10px;border-radius:10px;border:1px solid #e6eef6;background:#fff;text-align:center;cursor:pointer;font-weight:700;color:#16324f}
  .svc.active{background:linear-gradient(180deg,#fff,#f3fbff);border-color:var(--accent);box-shadow:0 6px 18px rgba(45,156,219,0.06)}
  input[type="number"]{width:100%;padding:10px;border-radius:8px;border:1px solid #e6eef6;background:#fff;font-size:15px;margin-top:6px}
  .grid-3{display:grid;grid-template-columns:repeat(3,1fr);gap:8px;margin-top:8px}
  .tabs{display:flex;gap:8px}
  .tab{padding:8px 12px;border-radius:8px;background:#fff;border:1px solid #e9f3fb;cursor:pointer;font-weight:700}
  .tab.active{background:linear-gradient(180deg,#ffffff,#f3fbff);border-color:var(--brand);color:var(--brand);box-shadow:0 6px 14px rgba(139,0,0,0.06)}

  .result{margin-top:12px;padding:12px;border-radius:10px;background:var(--muted);border:1px solid #eaf6fb}
  .row{display:flex;justify-content:space-between;padding:6px 0;font-weight:700}
  .small{font-size:13px;color:#546c7a;margin-top:8px}

  .actions{display:flex;gap:8px;margin-top:12px}
  .btn{padding:10px 12px;border-radius:10px;border:none;cursor:pointer;font-weight:700}
  .btn.primary{background:var(--brand);color:#fff}
  .btn.ghost{background:#fff;border:1px solid #e6eef6;color:var(--text)}

  /* Right column */
  .info .h{font-size:16px;margin:0}
  .info p{color:#455a64}

  @media (max-width:880px){
    .layout{grid-template-columns:1fr}
    .wrap{padding:12px}
  }
</style>
</head>
<body>
  <div class="wrap">
    <div class="header">
      <div class="logo">MPC</div>
      <div>
        <h1>Maria's Professional Cleaning — Calculadora (Arizona)</h1>
        <p class="lead">Rápido: cotiza por SQFT o por Hora. Valores por defecto alineados a mercado AZ — editables.</p>
      </div>
    </div>

    <div class="layout">
      <!-- LEFT: calculator controls -->
      <div class="card" aria-live="polite">
        <div style="display:flex;gap:10px;align-items:center;justify-content:space-between">
          <div style="font-weight:800">Opciones</div>
          <div style="font-size:13px;color:#64748b">MariaProfessionalCleaning.com</div>
        </div>

        <div style="margin-top:12px" class="tabs" role="tablist">
          <div class="tab active" data-mode="sqft">Por SQFT</div>
          <div class="tab" data-mode="hour">Por Hora</div>
        </div>

        <label>Selecciona servicio</label>
        <div class="service-row" id="services">
          <div class="svc active" data-service="regular">Regular</div>
          <div class="svc" data-service="deep">Profunda</div>
          <div class="svc" data-service="post1">Post-Const (One-time)</div>
        </div>

        <div style="margin-top:8px" id="postOptions" >
          <!-- hidden until "post" selected -->
          <div class="service-row" style="margin-top:8px">
            <div class="svc" data-service="postMulti">Post-Const (Multi-Phase)</div>
            <div class="svc" data-service="power">Power Washing</div>
          </div>
        </div>

        <!-- SQFT Inputs -->
        <div id="mode-sqft" style="margin-top:12px">
          <label>Sqft</label>
          <input id="sqft" type="number" min="0" placeholder="Ej. 1500" value="1500" />

          <label style="margin-top:12px">Precios por sqft (editable)</label>
          <div class="grid-3">
            <input id="price_regular_sqft" type="number" step="0.01" value="0.12" />
            <input id="price_deep_sqft" type="number" step="0.01" value="0.20" />
            <input id="price_power_sqft" type="number" step="0.01" value="0.20" />
          </div>

          <div class="small">Post-construction usa componentes específicos (one-time = 0.80/sqft; multi-phase = 0.88/sqft).</div>
        </div>

        <!-- Hour Inputs -->
        <div id="mode-hour" style="display:none;margin-top:12px">
          <label>Horas estimadas (por técnico)</label>
          <input id="hours" type="number" min="0" step="0.1" placeholder="Ej. 2" />

          <label style="margin-top:10px">Número de técnicos</label>
          <input id="techs" type="number" min="1" step="1" value="1" />

          <label style="margin-top:12px">Precios por hora (editable)</label>
          <div class="grid-3">
            <input id="price_regular_hr" type="number" step="1" value="40" />
            <input id="price_deep_hr" type="number" step="1" value="50" />
            <input id="price_post_hr" type="number" step="1" value="60" />
          </div>

          <div class="small">Precio por técnico por hora. El total = hrs × técnicos × tarifa.</div>
        </div>

        <div class="result" id="resultBox">
          <div class="row"><div>Servicio</div><div id="r_service">Regular</div></div>
          <div class="row"><div>Detalle</div><div id="r_detail">—</div></div>
          <div class="row"><div>Precio / unidad</div><div id="r_price">$0.00</div></div>
          <div class="row" style="font-size:16px"><div>Total estimado</div><div id="r_total">$0.00</div></div>

          <div id="hourExtras" style="display:none;margin-top:8px">
            <div class="row"><div>Horas totales</div><div id="r_total_hours">0</div></div>
            <div class="row"><div>Ingreso / hora (total)</div><div id="r_income_hour">$0.00</div></div>
          </div>

        </div>

        <div class="actions">
          <button class="btn primary" id="btnCopy">Copiar</button>
          <button class="btn ghost" id="btnCSV">CSV</button>
          <button class="btn ghost" id="btnClear">Limpiar</button>
        </div>

        <p class="small" style="margin-top:10px">Minimo recomendado: $100 (considera configurar en producción si lo deseas).</p>
      </div>

      <!-- RIGHT: info and branding -->
      <div class="card info">
        <h3 class="h">Maria's Professional Cleaning — Arizona</h3>
        <p>Esta calculadora usa tarifas recomendadas para Arizona. Valores editables para pruebas. Si quieres, puedo fijar tarifas y eliminar la edición.</p>

        <h4 style="margin-top:10px">Post-Construction pricing (your breakdown)</h4>
        <ul style="color:#334455">
          <li><strong>One-time</strong>: OneTime 0.50 + Windows 0.20 + Patio 0.10 = <strong>0.80 / sqft</strong></li>
          <li><strong>Multi-Phase</strong>: Rough 0.30 + Final 0.40 + Refresh 0.18 + Windows 0.20 + Patio 0.10 = <strong>0.88 / sqft</strong></li>
          <li>Hourly post-construction default: <strong>$60/hr</strong></li>
        </ul>

        <p style="margin-top:12px;color:#334455">Brand & site: <a href="https://mariaprofessionalcleaning.com" target="_blank" rel="noreferrer">mariaprofessionalcleaning.com</a></p>
      </div>
    </div>
  </div>

<script>
  // Elements
  const tabs = document.querySelectorAll('.tab');
  const modeSqft = document.getElementById('mode-sqft');
  const modeHour = document.getElementById('mode-hour');

  const svcEls = document.querySelectorAll('#services .svc');
  const postOptions = document.getElementById('postOptions');

  // Inputs
  const sqft = document.getElementById('sqft');
  const price_regular_sqft = document.getElementById('price_regular_sqft');
  const price_deep_sqft = document.getElementById('price_deep_sqft');
  const price_power_sqft = document.getElementById('price_power_sqft');

  const hours = document.getElementById('hours');
  const techs = document.getElementById('techs');
  const price_regular_hr = document.getElementById('price_regular_hr');
  const price_deep_hr = document.getElementById('price_deep_hr');
  const price_post_hr = document.getElementById('price_post_hr');

  // Results
  const r_service = document.getElementById('r_service');
  const r_detail = document.getElementById('r_detail');
  const r_price = document.getElementById('r_price');
  const r_total = document.getElementById('r_total');
  const r_total_hours = document.getElementById('r_total_hours');
  const r_income_hour = document.getElementById('r_income_hour');
  const hourExtras = document.getElementById('hourExtras');

  // Buttons
  const btnCopy = document.getElementById('btnCopy');
  const btnCSV = document.getElementById('btnCSV');
  const btnClear = document.getElementById('btnClear');

  // Service state
  let activeService = 'regular'; // regular, deep, post1, postMulti, power

  // Post service quick handling: add click listeners for postOptions later
  function clearServiceActive(){
    svcEls.forEach(s=>s.classList.remove('active'));
    // also remove any in postOptions children
    const extras = postOptions.querySelectorAll('.svc');
    extras.forEach(x=>x.classList.remove('active'));
  }

  svcEls.forEach(s=>{
    s.addEventListener('click', ()=>{
      clearServiceActive();
      s.classList.add('active');
      activeService = s.dataset.service;
      // if post selected, show postOptions (which includes postMulti and power)
      if(activeService.startsWith('post')){
        // show postOptions so user can choose alternate post modes or power
        postOptions.style.display = 'block';
      } else {
        postOptions.style.display = 'none';
        // ensure post options deactivated
        const extras = postOptions.querySelectorAll('.svc');
        extras.forEach(x=>x.classList.remove('active'));
      }
      refresh();
    });
  });

  // postOptions buttons (these are inside the DOM as svc class via HTML)
  postOptions.querySelectorAll('.svc').forEach(btn=>{
    btn.addEventListener('click', ()=>{
      // when one of these is clicked, it becomes the active service
      clearServiceActive();
      btn.classList.add('active');
      // mark activeService accordingly
      const key = btn.dataset.service;
      activeService = key; // postMulti or power
      // also highlight the main "post1" button visually if user expects that
      const mainPost = document.querySelector('#services .svc[data-service="post1"]');
      if(mainPost) mainPost.classList.add('active');
      refresh();
    });
  });

  // Tabs: sqft / hour
  tabs.forEach(t=>{
    t.addEventListener('click', ()=>{
      tabs.forEach(x=>x.classList.remove('active'));
      t.classList.add('active');
      const mode = t.dataset.mode;
      if(mode==='sqft'){ modeSqft.style.display='block'; modeHour.style.display='none'; hourExtras.style.display='none'; }
      else { modeSqft.style.display='none'; modeHour.style.display='block'; }
      refresh();
    });
  });

  // Money formatter
  function money(n){ return '$' + Number(n).toLocaleString('en-US',{minimumFractionDigits:2,maximumFractionDigits:2}); }

  function refresh(){
    r_service.textContent = activeService === 'regular' ? 'Regular' :
                            activeService === 'deep' ? 'Profunda' :
                            activeService === 'post1' ? 'Post-Construction (One-time)' :
                            activeService === 'postMulti' ? 'Post-Construction (Multi-Phase)' :
                            activeService === 'power' ? 'Power Washing' : activeService;

    const mode = document.querySelector('.tab.active').dataset.mode;
    if(mode === 'sqft'){
      hourExtras.style.display = 'none';
      const s = Number(sqft.value) || 0;
      if(activeService === 'regular'){
        const p = Number(price_regular_sqft.value) || 0;
        r_detail.textContent = `${s} sqft`;
        r_price.textContent = money(p) + ' /sqft';
        r_total.textContent = money(s * p);
      } else if(activeService === 'deep'){
        const p = Number(price_deep_sqft.value) || 0;
        r_detail.textContent = `${s} sqft`;
        r_price.textContent = money(p) + ' /sqft';
        r_total.textContent = money(s * p);
      } else if(activeService === 'power'){
        const p = Number(price_power_sqft.value) || 0;
        r_detail.textContent = `${s} sqft`;
        r_price.textContent = money(p) + ' /sqft';
        r_total.textContent = money(s * p);
      } else if(activeService === 'post1'){
        // One-time: total 0.80 / sqft (0.5 + 0.2 + 0.1)
        const p = 0.80;
        r_detail.textContent = `${s} sqft`;
        r_price.textContent = money(p) + ' /sqft (one-time)';
        r_total.textContent = money(s * p);
      } else if(activeService === 'postMulti'){
        // multi-phase = 0.88 / sqft
        const p = 0.88;
        r_detail.textContent = `${s} sqft (multi-phase)`;
        r_price.textContent = money(p) + ' /sqft';
        r_total.textContent = money(s * p);
      } else {
        r_detail.textContent = '—';
        r_price.textContent = '$0.00';
        r_total.textContent = '$0.00';
      }
    } else {
      // hour mode
      hourExtras.style.display = 'block';
      const hrs = Number(hours.value) || 0;
      const t = Number(techs.value) || 1;
      if(activeService === 'regular'){
        const ph = Number(price_regular_hr.value) || 0;
        const total = ph * hrs * t;
        r_detail.textContent = `${hrs} h × ${t} tech(s)`;
        r_price.textContent = money(ph) + ' /h (per tech)';
        r_total.textContent = money(total);
        r_total_hours.textContent = (hrs * t).toFixed(2);
        r_income_hour.textContent = money((total) / Math.max(1, hrs * t));
      } else if(activeService === 'deep'){
        const ph = Number(price_deep_hr.value) || 0;
        const total = ph * hrs * t;
        r_detail.textContent = `${hrs} h × ${t} tech(s)`;
        r_price.textContent = money(ph) + ' /h (per tech)';
        r_total.textContent = money(total);
        r_total_hours.textContent = (hrs * t).toFixed(2);
        r_income_hour.textContent = money((total) / Math.max(1, hrs * t));
      } else if(activeService === 'post1' || activeService === 'postMulti'){
        const ph = Number(price_post_hr.value) || 0;
        const total = ph * hrs * t;
        r_detail.textContent = `${hrs} h × ${t} tech(s)`;
        r_price.textContent = money(ph) + ' /h (per tech)';
        r_total.textContent = money(total);
        r_total_hours.textContent = (hrs * t).toFixed(2);
        r_income_hour.textContent = money((total) / Math.max(1, hrs * t));
      } else if(activeService === 'power'){
        // use deep/hr as default for power if not specified separately
        const ph = Number(price_deep_hr.value) || 45;
        const total = ph * hrs * t;
        r_detail.textContent = `${hrs} h × ${t} tech(s)`;
        r_price.textContent = money(ph) + ' /h (per tech)';
        r_total.textContent = money(total);
        r_total_hours.textContent = (hrs * t).toFixed(2);
        r_income_hour.textContent = money((total) / Math.max(1, hrs * t));
      } else {
        r_detail.textContent = '—';
        r_price.textContent = '$0.00';
        r_total.textContent = '$0.00';
      }
    }
  }

  // Wire inputs to refresh
  [sqft, price_regular_sqft, price_deep_sqft, price_power_sqft,
   hours, techs, price_regular_hr, price_deep_hr, price_post_hr].forEach(el=>{
    el.addEventListener('input', refresh);
  });

  // CSV export
  btnCSV.addEventListener('click', ()=>{
    const rows = [
      ['Service','Detail','Price per unit','Total'],
      [r_service.textContent, r_detail.textContent, r_price.textContent, r_total.textContent]
    ];
    const csv = rows.map(r=> r.map(c=> `"${String(c).replace(/"/g,'""')}"`).join(',')).join('\n');
    const blob = new Blob([csv],{type:'text/csv;charset=utf-8;'});
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a'); a.href = url; a.download = 'cotizacion_marias_cleaning.csv';
    document.body.appendChild(a); a.click(); a.remove(); URL.revokeObjectURL(url);
  });

  // Copy textual summary
  btnCopy.addEventListener('click', ()=>{
    const text =
`Maria's Professional Cleaning — Cotización
Servicio: ${r_service.textContent}
Detalle: ${r_detail.textContent}
Precio: ${r_price.textContent}
Total: ${r_total.textContent}
Fuente: mariaprofessionalcleaning.com`;
    navigator.clipboard.writeText(text).then(()=> alert('Copiado al portapapeles.'));
  });

  btnClear.addEventListener('click', ()=>{
    sqft.value = '';
    hours.value = '';
    techs.value = '1';
    refresh();
  });

  // Init
  // ensure postOptions hidden until needed
  postOptions.style.display = 'none';
  // ensure postOptions svc buttons have data attributes (set in HTML)
  // Add data-service to postOptions children for safety:
  (function ensurePostButtons(){
    const extras = postOptions.querySelectorAll('.svc');
    extras.forEach((el, i)=>{
      if(!el.dataset.service){
        if(i===0) el.dataset.service='postMulti';
        else el.dataset.service='power';
      }
    });
  })();

  // Attach click on dynamic postOptions svc (they exist in DOM)
  postOptions.querySelectorAll('.svc').forEach(b=>{
    b.addEventListener('click', ()=>{
      // mark active correctly: deselect main row and others
      svcEls.forEach(s=>s.classList.remove('active'));
      // keep main post1 visually active too:
      const main = document.querySelector('#services .svc[data-service="post1"]');
      if(main) main.classList.add('active');
      postOptions.querySelectorAll('.svc').forEach(x=>x.classList.remove('active'));
      b.classList.add('active');
      activeService = b.dataset.service;
      refresh();
    });
  });

  // initial calc
  refresh();
</script>
</body>
</html>
